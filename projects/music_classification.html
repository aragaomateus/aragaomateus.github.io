<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Music Genre Classification | Mateus Aragão</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        :root {
            --primary-black: #1a1a1a;
            --accent-blue: #2c3e50;
            --accent-warm: #7f8c8d;
            --light-gray: #f8f9fa;
            --medium-gray: #6c757d;
            --dark-gray: #495057;
            --white: #ffffff;
            --border-light: #e9ecef;
            --grid-gap: 32px;
        }
        
        body {
            font-family: 'Inter', sans-serif;
            background: #fefefe;
            color: var(--primary-black);
            line-height: 1.6;
            font-size: 16px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }
        
        .grid-container {
            display: grid;
            grid-template-columns: repeat(12, 1fr);
            gap: var(--grid-gap);
            max-width: 1000px;
            margin: 0 auto;
            padding: 0 var(--grid-gap);
            flex: 1;
        }
        
        /* Navigation */
        nav {
            grid-column: 1 / -1;
            padding: 2rem 0;
            border-bottom: 1px solid var(--border-light);
            margin-bottom: 3rem;
        }
        
        .nav-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .logo {
            font-weight: 600;
            font-size: 1.2rem;
            color: var(--primary-black);
            letter-spacing: -0.01em;
        }
        
        .nav-links {
            display: flex;
            gap: 3rem;
            list-style: none;
        }
        
        .nav-links a {
            text-decoration: none;
            color: var(--medium-gray);
            font-weight: 400;
            transition: color 0.2s ease;
            font-size: 0.95rem;
        }
        
        .nav-links a.active,
        .nav-links a:hover {
            color: var(--primary-black);
        }
        
        /* Article Header */
        .article-header {
            grid-column: 1 / -1;
            text-align: center;
            margin-bottom: 4rem;
            padding-bottom: 2rem;
            border-bottom: 1px solid var(--border-light);
        }
        
        .article-header h1 {
            font-size: 2.5rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: var(--primary-black);
            letter-spacing: -0.03em;
        }
        
        .article-header h4 {
            font-size: 1.1rem;
            font-weight: 400;
            color: var(--medium-gray);
        }
        
        /* Main Content */
        .main-content {
            grid-column: 1 / -1;
            margin-bottom: 4rem;
        }
        
        .section {
            margin-bottom: 3rem;
        }
        
        .section h5 {
            font-size: 1.3rem;
            font-weight: 600;
            margin-bottom: 1rem;
            color: var(--primary-black);
            letter-spacing: -0.02em;
        }
        
        .section h6 {
            font-size: 1.1rem;
            font-weight: 500;
            margin: 2rem 0 1rem 0;
            color: var(--accent-blue);
        }
        
        .section p {
            margin-bottom: 1.5rem;
            line-height: 1.7;
            color: var(--dark-gray);
        }
        
        /* Code Blocks */
        .code-section {
            background: var(--light-gray);
            border-left: 4px solid var(--accent-blue);
            margin: 2rem 0;
        }
        
        .code-section pre {
            background: var(--primary-black);
            color: #e6e6e6;
            padding: 2rem;
            overflow-x: auto;
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            font-size: 0.85rem;
            line-height: 1.5;
        }
        
        .code-section code {
            font-family: inherit;
        }
        
        /* Images */
        .image-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            margin: 2rem 0;
        }
        
        .image-item {
            text-align: center;
        }
        
        .image-item img {
            width: 100%;
            height: auto;
            border: 1px solid var(--border-light);
        }
        
        .image-item figcaption {
            margin-top: 0.5rem;
            font-size: 0.85rem;
            color: var(--medium-gray);
            font-style: italic;
        }
        
        /* Back Link */
        .back-link {
            grid-column: 1 / -1;
            margin-bottom: 2rem;
        }
        
        .back-link a {
            color: var(--medium-gray);
            text-decoration: none;
            font-size: 0.9rem;
            transition: color 0.2s ease;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .back-link a:hover {
            color: var(--primary-black);
        }
        
        /* Footer */
        footer {
            background: var(--primary-black);
            color: var(--white);
            padding: 2rem 0;
            text-align: center;
            margin-top: auto;
        }
        
        .social-icons {
            display: flex;
            justify-content: center;
            gap: 1.5rem;
            margin-top: 1rem;
        }
        
        .social-icons a {
            color: var(--medium-gray);
            font-size: 1.2rem;
            transition: color 0.2s ease;
        }
        
        .social-icons a:hover {
            color: var(--white);
        }
        
        /* Responsive Design */
        @media (max-width: 768px) {
            .grid-container {
                padding: 0 20px;
            }
            
            .nav-links {
                gap: 1.5rem;
            }
            
            .article-header h1 {
                font-size: 2rem;
            }
            
            .image-grid {
                grid-template-columns: 1fr;
                gap: 1rem;
            }
            
            .code-section pre {
                padding: 1rem;
                font-size: 0.8rem;
            }
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" />
</head>
<body>
    <div class="grid-container">
        <nav>
            <div class="nav-content">
                <div class="logo">Mateus Silva Aragão</div>
                <ul class="nav-links">
                    <li><a href="/index.html">Resume</a></li>
                    <li><a href="/projects.html" class="active">Projects</a></li>
                    <li><a href="/contact.html">Contact</a></li>
                </ul>
            </div>
        </nav>

        <div class="back-link">
            <a href="/projects.html">
                <i class="fas fa-arrow-left"></i> Back to Projects
            </a>
        </div>

        <header class="article-header">
            <h1>Music Genre Classification</h1>
            <h4>The Fundamentals of Machine Learning Capstone Project</h4>
        </header>

        <main class="main-content">
            <section class="section">
                <h5>The Final Model</h5>
                <p>
                    The final model selected for this project was XGBoost. More specifically, the model implemented was an XGBoost Classifier, configured as a One-vs-Rest Classifier. The model was defined with 180 estimators, a maximum depth of 25, a learning rate of 0.25, and an evaluation metric of 'mlogloss'. XGBoost is a potent gradient-boosting algorithm, renowned for its efficacy across a broad range of classification problems.
                </p>
                <p>
                    Gradient boosting is a machine learning technique where new models are created that predict the residuals or errors of prior models, then added together to make the final prediction. It leverages the idea of transforming weak learners into strong learners, thereby continually improving the model's accuracy.
                </p>
                <p>
                    Compared to a Random Forest Classifier, XGBoost often demonstrates superior performance due to its ability to limit overfitting, as it incorporates a regularization term in its loss function which a random forest does not. It adds a penalty for complexity, resulting in simpler and more generalizable models.
                </p>
            </section>

            <section class="section">
                <h5>Evaluation Metric</h5>
                <p>
                    The Area Under the ROC Curve (AUC-ROC) is the evaluation metric for this project. AUC-ROC is a suitable metric when dealing with imbalanced datasets, as it considers both the true positive rate and the false positive rate, providing a robust measure of model performance across all possible classification thresholds. This characteristic makes it an appropriate choice for genre classification, where the distribution of songs across genres may be imbalanced.
                </p>
            </section>

            <section class="section">
                <h5>Model Building Process</h5>
                
                <h6>Data Preprocessing</h6>
                <p>
                    The first step in the model-building process was to preprocess the data. This involved handling missing values and scaling the features. Missing values in the dataset were handled by dropping the rows with NaNs since they constituted only a small fraction of the data. In addition, columns with '?' were identified and converted to NaNs. These values were imputed with the median value of the respective column per genre.
                </p>
                <p>
                    Feature scaling was performed using the StandardScaler. This ensured that all features had a mean of 0 and a standard deviation of 1, thereby standardizing the range of the independent features in the data. Certain features such as 'instance_id', 'artist_name', 'track_name', and 'obtained_date' were dropped from the dataset because they were not significant for genre classification.
                </p>

                <h6>Dimensionality Reduction</h6>
                <p>
                    Dimensionality reduction strategies such as PCA and t-SNE were explored. However, none of these strategies improved the AUC-ROC score, indicating that these methods were not beneficial for this particular dataset.
                </p>

                <h6>Model Selection and Cross-Validation</h6>
                <p>
                    The model testing process was a crucial part of the project. It began by experimenting with a variety of machine learning models on data preprocessed with t-SNE for dimensionality reduction. The models tested include Logistic Regression, Random Forest, Support Vector Machines, K-Nearest Neighbors, and XGBoost.
                </p>
                <p>
                    Logistic Regression, a simple and widely-used classification algorithm, was chosen due to its efficiency and ease of interpretation. However, it performed poorly, achieving only 0.305566 accuracy and an AUC-ROC score of 0.790516. This might be because logistic regression may not handle complex relationships in data well, particularly when there are interactions between features.
                </p>
                <p>
                    XGBoost, a powerful gradient boosting algorithm, performed better than the previous models with an accuracy of 0.471309 and an AUC-ROC score of 0.873206. The effectiveness of XGBoost can be attributed to its ability to capture complex relationships in the data and its robustness against overfitting through the use of gradient boosting.
                </p>

                <h6>Testing Neural Networks</h6>
                <p>
                    Model 1 consisted of a simple feed-forward neural network with two hidden layers. The first layer had 64 neurons, and the second had 128 neurons. However, despite its simplicity, it failed to provide satisfactory accuracy.
                </p>
                <p>
                    Model 2 was a slightly larger network with more neurons in each layer (128 in the first layer and 256 in the second layer), but it also did not yield satisfactory results. This could be because while increasing the number of neurons can improve the model's capacity to learn complex patterns, it can also make it more prone to overfitting.
                </p>

                <div class="code-section">
                    <pre><code class="python"># Define the neural network models
class Model1(nn.Module):
    def __init__(self, input_size, num_classes):
        super(Model1, self).__init__()
        self.layer1 = nn.Linear(input_size, 64)
        self.layer2 = nn.Linear(64, 128)
        self.layer3 = nn.Linear(128, num_classes)
        
    def forward(self, x):
        x = nn.functional.relu(self.layer1(x))
        x = nn.functional.relu(self.layer2(x))
        x = self.layer3(x)
        return x

class Model2(nn.Module):
    def __init__(self, input_size, num_classes):
        super(Model2, self).__init__()
        self.layer1 = nn.Linear(input_size, 128)
        self.layer2 = nn.Linear(128, 256)
        self.layer3 = nn.Linear(256, num_classes)
        
    def forward(self, x):
        x = nn.functional.relu(self.layer1(x))
        x = nn.functional.relu(self.layer2(x))
        x = self.layer3(x)
        return x

class Model3(nn.Module):
    def __init__(self, input_size, num_classes):
        super(Model3, self).__init__()
        self.layer1 = nn.Linear(input_size, 128)
        self.layer2 = nn.Linear(128, 128)
        self.layer3 = nn.Linear(128, num_classes)
        self.dropout = nn.Dropout(0.5)
        self.batchnorm = nn.BatchNorm1d(128)
    
    def forward(self, x):
        x = nn.functional.relu(self.layer1(x))
        x = self.batchnorm(x)
        x = nn.functional.relu(self.layer2(x))
        x = self.dropout(x)
        x = self.layer3(x)
        return x</code></pre>
                </div>
            </section>

            <section class="section">
                <h5>Results and Discussion</h5>
                <p>
                    The XGBoost model achieved the best AUC-ROC score of 0.94, indicating a high performance in genre classification. The model used the original set of predictors without dimensionality reduction. This suggests that the initial feature space contained important information that was key to successful genre classification and that dimensionality reduction methods like PCA and t-SNE were unable to retain this information.
                </p>
                <p>
                    The most important features for the XGBoost classification were 'popularity', 'danceability', 'speechiness', and 'instrumentalness'. This indicates that these features have a significant impact on the genre of a song, and thus can be the focus of future research or application in similar tasks.
                </p>
                <p>
                    The final XGBoost model that was chosen uses the dataset scaled but not dimensionally reduced. This allowed the model to make use of the full feature space and achieve an AUC score of 0.94, the highest score in all the experiments. This achievement illustrates the potential of XGBoost for multi-class classification problems and encourages further exploration and application of this algorithm.
                </p>

                <div class="image-grid">
                    <div class="image-item">
                        <img src="model with tsne.png" alt="Model with t-SNE results">
                        <figcaption>Model performance with t-SNE dimensionality reduction</figcaption>
                    </div>
                    <div class="image-item">
                        <img src="best sofar.png" alt="Best model results">
                        <figcaption>Final XGBoost model performance results</figcaption>
                    </div>
                </div>
            </section>

            <section class="section">
                <div style="text-align: center; margin-top: 3rem;">
                    <a href="https://github.com/aragaomateus/fundamentalsOfML/tree/master/capstone%20Project" target="_blank" style="display: inline-flex; align-items: center; gap: 0.5rem; background: var(--primary-black); color: var(--white); padding: 0.8rem 1.5rem; text-decoration: none; font-weight: 500; transition: background 0.2s ease;">
                        <i class="fab fa-github"></i> View Source Code on GitHub
                    </a>
                </div>
            </section>
        </main>
    </div>

    <footer>
        <p>&copy; 2024 Mateus Silva Aragão. All rights reserved.</p>
        <div class="social-icons">
            <a href="https://www.linkedin.com/in/mateus-silva-aragao-986933162/" target="_blank" title="LinkedIn">
                <i class="fab fa-linkedin"></i>
            </a>
            <a href="mailto:mateusilvaragao@gmail.com" title="Email">
                <i class="fas fa-envelope"></i>
            </a>
            <a href="https://github.com/aragaomateus" target="_blank" title="GitHub">
                <i class="fab fa-github"></i>
            </a>
            <a href="https://medium.com/@aragaosm" target="_blank" title="Medium">
                <i class="fab fa-medium"></i>
            </a>
        </div>
    </footer>
</body>
</html>